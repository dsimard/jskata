(function(){var a={dids:[],undids:[],canUndo:function(){return this.dids.length>0},canRedo:function(){return this.undids.length>0},push:function(a){this.execute(null,a)},execute:function(c,d,e){var f;if(e===undefined||e===null)e={};this.isFct(c)&&e.async!==!0&&(f=c()),a.isInAsyncRedo!==!0&&(this.undids=[]),a.isInAsyncRedo=!1,e.data&&(f=e.data);var g=function(){d(f)};return this.dids.push({redo:c,undo:d,wrappedUndo:g,options:e}),this.fireEvents(),f},undo:function(){var b=this.dids&&this.dids.length>0?this.dids.pop():null;this.isFct(b.wrappedUndo)&&(b.wrappedUndo(),this.isFct(b.redo)&&this.undids.push({redo:b.redo,undo:b.undo,options:b.options})),this.fireEvents()},redo:function(){var c=this.undids&&this.undids.length>0?this.undids.pop():null;if(this.isFct(c.redo)){a.isInAsyncRedo=c.options.async;var d=c.redo();c.options.data&&(d=c.options.data);var e=function(){c.undo(d)};c.options.async!==!0&&this.dids.push({redo:c.redo,undo:c.undo,wrappedUndo:e,options:c.options})}this.fireEvents()},onChange:function(){return!1},onEmpty:function(){return!1},fireEvents:function(){this.onChange&&this.onChange(),this.dids.length===0&&this.undids.length===0&&this.onEmpty()},isFct:function(a){return a&&typeof a=="function"}};typeof window!="undefined"?(window.javascriptKataDotCom===undefined&&(window.javascriptKataDotCom={}),window.jsKata===undefined&&(window.jsKata=window.javascriptKataDotCom),window.jsk===undefined&&(window.jsk=window.javascriptKataDotCom),window._===undefined&&(window._=window.javascriptKataDotCom),window.javascriptKataDotCom.undo=a,window.javascriptKataDotCom.u=a,window.jskataUndo=window.javascriptKataDotCom.undo):typeof module!="undefined"&&typeof module.exports!="undefined"&&(module.exports=a)})()